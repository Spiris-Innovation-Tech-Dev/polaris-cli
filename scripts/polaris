#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SKILL_DIR="$(cd "${SCRIPT_DIR}/.." && pwd)"

# Prefer pre-built binary, fall back to cargo run for development
if [[ -x "${SKILL_DIR}/bin/polaris" ]]; then
  exec "${SKILL_DIR}/bin/polaris" "$@"
elif command -v cargo >/dev/null 2>&1 && [[ -f "${SKILL_DIR}/Cargo.toml" ]]; then
  exec cargo run --quiet --manifest-path "${SKILL_DIR}/Cargo.toml" -p polaris-cli -- "$@"
else
  echo "polaris binary not found. Run: scripts/install.sh" >&2
  exit 1
fi
